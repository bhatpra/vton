allow_embedding: false
dependencies: []
metadata: {description: 'Upload user, cloth and see virtual try on', title: DSI Virtual Try on}
name: VTON
native_deps:
  head_html: |
    <script>
      function compressImage(file, maxWidth) {
        return new Promise((resolve, reject) => {
          const reader = new FileReader();
          reader.onload = function(e) {
            const img = new Image();
            img.onload = function() {
              let width = img.width;
              let height = img.height;
              if (width > maxWidth) {
                height = Math.floor((maxWidth / width) * height);
                width = maxWidth;
              }
              const canvas = document.createElement("canvas");
              canvas.width = width;
              canvas.height = height;
              canvas.getContext("2d").drawImage(img, 0, 0, width, height);

              // Example: JPEG at 80% quality
              const dataUrl = canvas.toDataURL("image/jpeg", 0.8);
              resolve(dataUrl);
            };
            img.onerror = reject;
            img.src = e.target.result;
          };
          reader.onerror = reject;
          reader.readAsDataURL(file);
        });
      }

      window.compressImage = compressImage; // Expose to anvil.js.call_js
    </script>
package_name: VTON
renamed: true
runtime_options:
  client_version: '3'
  server_spec: {base: python310-machine-learning}
  server_version: python3-sandbox
  version: 2
services:
- client_config: {}
  server_config: {}
  source: /runtime/services/tables.yml
startup_form: Form1
